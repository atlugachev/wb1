<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Автомобильный мир - Тест-драйв</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .error {
            color: red;
            font-size: 0.9em;
        }
        .error-field {
            border: 2px solid red !important;
        }
        .border-section {
            border: 1px solid #dee2e6;
        }
        .rounded-section {
            border-radius: 5px;
        }
        .messages {
            margin-bottom: 20px;
        }
        .message {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
        }
        .error-message {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .success-message {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
    </style>
</head>
<body>
    <header class="container-fluid py-3 border rounded mb-4">
        <div class="row align-items-center justify-content-between">
            <div id="logo" class="col-12 col-lg-3 d-flex justify-content-start align-items-center mb-3 mb-lg-0">
                <img src="FERRARI_logo.png" width="100" alt="Логотип сайта">
                <h1 id="site-name" class="text-dark ml-3 ms-3 mb-0 d-lg-none" style="font-size: 24px;">Автомир</h1>
            </div>
    
            <h1 id="site-name" class="col-12 col-lg-6 text-dark text-center d-none d-lg-block mb-0" style="font-size: 32px;">Автомобильный мир</h1>
    
            <nav class="col-12 col-lg-auto nav-desktop mb-4 mb-lg-0 align-self-lg-start">
                <ul class="nav flex-column flex-lg-row align-items-start ps-0 ms-0">
                    <li class="nav-item">
                        <a class="nav-link text-dark ps-0" href="#link">Модели</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark ps-0" href="#table-header">Характеристики</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark ps-0" href="#form">Тест-драйв</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    
    <main class="container col-12 col-lg-7">
        <div class="row">
            <!-- Форма -->
            <section id="forma" class="col-12 mb-4 p-4 border-section rounded-section order-3">
                <h2 class="text-center text-dark mb-3">Запись на тест-драйв</h2>
                
                <!-- Сообщения об ошибках/успехе -->
                <?php
                // Отображение сообщений об ошибках
                if (isset($_COOKIE['form_errors'])) {
                    $errors = json_decode($_COOKIE['form_errors'], true);
                    echo '<div class="messages">';
                    foreach ($errors as $field => $message) {
                        echo '<div class="message error-message">Ошибка в поле "'.ucfirst($field).'": '.htmlspecialchars($message).'</div>';
                    }
                    echo '</div>';
                }
                
                // Отображение сообщения об успехе
                if (isset($_COOKIE['form_success'])) {
                    echo '<div class="messages">
                            <div class="message success-message">'.htmlspecialchars($_COOKIE['form_success']).'</div>
                          </div>';
                }
                ?>
                
                <form id="form" method="POST" action="process_form.php">
                    <div class="form-group">
                        <label for="fio">ФИО:</label>
                        <input type="text" class="form-control <?php echo isset($_COOKIE['error_fio']) ? 'error-field' : ''; ?>" 
                               id="fio" name="fio" placeholder="Введите ФИО" 
                               value="<?php echo isset($_COOKIE['fio']) ? htmlspecialchars($_COOKIE['fio']) : ''; ?>" required>
                        <?php if (isset($_COOKIE['error_fio'])): ?>
                            <small class="error"><?php echo htmlspecialchars($_COOKIE['error_fio']); ?></small>
                        <?php endif; ?>
                    </div>
                    
                    <div class="form-group">
                        <label for="number">Телефон:</label>
                        <input type="tel" class="form-control <?php echo isset($_COOKIE['error_number']) ? 'error-field' : ''; ?>" 
                               id="number" name="number" placeholder="+7 (XXX) XXX-XX-XX" 
                               value="<?php echo isset($_COOKIE['number']) ? htmlspecialchars($_COOKIE['number']) : ''; ?>" required>
                        <?php if (isset($_COOKIE['error_number'])): ?>
                            <small class="error"><?php echo htmlspecialchars($_COOKIE['error_number']); ?></small>
                        <?php endif; ?>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">E-mail:</label>
                        <input type="email" class="form-control <?php echo isset($_COOKIE['error_email']) ? 'error-field' : ''; ?>" 
                               id="email" name="email" placeholder="example@domain.com" 
                               value="<?php echo isset($_COOKIE['email']) ? htmlspecialchars($_COOKIE['email']) : ''; ?>" required>
                        <?php if (isset($_COOKIE['error_email'])): ?>
                            <small class="error"><?php echo htmlspecialchars($_COOKIE['error_email']); ?></small>
                        <?php endif; ?>
                    </div>
                    
                    <div class="form-group">
                        <label for="birthday">Дата рождения:</label>
                        <input type="date" class="form-control <?php echo isset($_COOKIE['error_birthday']) ? 'error-field' : ''; ?>" 
                               id="birthday" name="birthday" 
                               value="<?php echo isset($_COOKIE['birthday']) ? htmlspecialchars($_COOKIE['birthday']) : ''; ?>" required>
                        <?php if (isset($_COOKIE['error_birthday'])): ?>
                            <small class="error"><?php echo htmlspecialchars($_COOKIE['error_birthday']); ?></small>
                        <?php endif; ?>
                    </div>
                    
                    <div class="form-group">
                        <label>Пол:</label><br>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" id="male" name="gender" value="male" 
                                   <?php echo (isset($_COOKIE['gender']) && $_COOKIE['gender'] == 'male') ? 'checked' : ''; ?>>
                            <label class="form-check-label" for="male">Мужской</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" id="female" name="gender" value="female" 
                                   <?php echo (isset($_COOKIE['gender']) && $_COOKIE['gender'] == 'female') ? 'checked' : ''; ?>>
                            <label class="form-check-label" for="female">Женский</label>
                        </div>
                        <?php if (isset($_COOKIE['error_gender'])): ?>
                            <small class="error"><?php echo htmlspecialchars($_COOKIE['error_gender']); ?></small>
                        <?php endif; ?>
                    </div>
                    
                    <div class="form-group">
                        <label for="model">Интересующие модели:</label>
                        <select multiple class="form-control <?php echo isset($_COOKIE['error_model']) ? 'error-field' : ''; ?>" 
                                id="model" name="model[]" required>
                            <option value="BMW M5" <?php echo (isset($_COOKIE['model']) && strpos($_COOKIE['model'], 'BMW M5') !== false) ? 'selected' : ''; ?>>BMW M5</option>
                            <option value="Mercedes E63" <?php echo (isset($_COOKIE['model']) && strpos($_COOKIE['model'], 'Mercedes E63') !== false) ? 'selected' : ''; ?>>Mercedes E63</option>
                            <option value="Audi RS6" <?php echo (isset($_COOKIE['model']) && strpos($_COOKIE['model'], 'Audi RS6') !== false) ? 'selected' : ''; ?>>Audi RS6</option>
                            <option value="Porsche 911" <?php echo (isset($_COOKIE['model']) && strpos($_COOKIE['model'], 'Porsche 911') !== false) ? 'selected' : ''; ?>>Porsche 911</option>
                        </select>
                        <?php if (isset($_COOKIE['error_model'])): ?>
                            <small class="error"><?php echo htmlspecialchars($_COOKIE['error_model']); ?></small>
                        <?php endif; ?>
                    </div>
                    
                    <div class="form-group">
                        <label for="comments">Дополнительные пожелания:</label>
                        <textarea class="form-control" id="comments" name="comments"><?php echo isset($_COOKIE['comments']) ? htmlspecialchars($_COOKIE['comments']) : ''; ?></textarea>
                    </div>
                    
                    <div class="form-group form-check">
                        <input type="checkbox" class="form-check-input <?php echo isset($_COOKIE['error_agreement']) ? 'error-field' : ''; ?>" 
                               id="agreement" name="agreement" <?php echo isset($_COOKIE['agreement']) ? 'checked' : ''; ?> required>
                        <label class="form-check-label" for="agreement">Согласен на обработку персональных данных</label>
                        <?php if (isset($_COOKIE['error_agreement'])): ?>
                            <small class="error"><?php echo htmlspecialchars($_COOKIE['error_agreement']); ?></small>
                        <?php endif; ?>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Отправить заявку</button>
                </form>
            </section>
        </div>
    </main>
    
    <footer class="container-fluid py-3 text-left mt-4" style="background-color: #333; color: white;">
        <p>&copy; Автомобильный мир 2023</p>
    </footer>
</body>
</html>
